{
    "contents" : "dlogProfile <- function(theta, DTR, NoiTR, XTR, Phi.est, lamb.est){\n  # Compute the correlation matrix.\n  Y <- NoiTR[,1]\n  X <- XTR\n  N <- length(Y)\n  PhiTime <- Phi.est[NoiTR[,2],]\n  psi <- matrix(0, nrow = N, ncol = N)\n  Gamma1 <- lamb.est[1]*exp(-DTR/theta[1])\n  Gamma2 <- lamb.est[2]*exp(-DTR/theta[2])\n  psi <- Gamma1*outer(PhiTime[,1],PhiTime[,1])+Gamma2*outer(PhiTime[,2],PhiTime[,2])\n  diag(psi) <- diag(psi)+theta[3]\n  U <- chol(psi)\n  psi.inv <- chol2inv(U)\n  # Compute the MLE for beta.\n  beta <- solve(crossprod(X, psi.inv %*% X), crossprod(X, psi.inv %*% Y))\n  # Compute the MLE for sigma.\n  resid <- Y - X %*% beta\n  \n  psi1 <- 1*DTR*Gamma1*outer(PhiTime[,1],PhiTime[,1])/(theta[1]^2) # if c = 1/theta\n  psi2 <- 1*DTR*Gamma2*outer(PhiTime[,2],PhiTime[,2])/(theta[2]^2) # change to -1\n  sigmaRes <- psi.inv %*% resid\n  theta1 <- sum(diag(psi.inv%*%psi1)) # -1*crossprod(sigmaRes, psi1%*%sigmaRes) + sum(diag(psi.inv%*%psi1))\n  theta2 <- sum(diag(psi.inv%*%psi2)) # -1*crossprod(sigmaRes, psi2%*%sigmaRes) + sum(diag(psi.inv%*%psi2))\n  sigma2 <- -1*crossprod(sigmaRes) + sum(diag(psi.inv))\n  # Log of the determinant of U.\n  prof <- c(theta1, theta2, sigma2)\n  return(prof)\n  # This is a test\n}\n# system.time({dlogProfile(theta0, DTR = DTR, NoiTR = NoiTR, XTR = XTR, Phi.est = Phi.est, lamb.est = lamb.est)})\n# OLD: 0.705\n# NEW: 0.357",
    "created" : 1412481152649.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2925148310",
    "id" : "8287261F",
    "lastKnownWriteTime" : 1412481159,
    "path" : "C:/Users/Guilherme Ludwig/Dropbox/Research/Spatio-Temporal models/Code/gfda/R/dlogProfile.R",
    "project_path" : "R/dlogProfile.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}